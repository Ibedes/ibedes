---
import Layout from "../../layouts/Layout.astro";
export const prerender = false;
const statusTabs = [
    { id: "pending", label: "Pending", badge: "âšª" },
    { id: "approved", label: "Approved", badge: "âœ…" },
    { id: "spam", label: "Spam", badge: "ðŸš«" },
    { id: "all", label: "All", badge: "ðŸ“‹" },
];
---

<Layout title="Komentar - Admin">
    <div class="comment-shell">
        <div class="comment-layout">
            <aside class="comment-sidebar" aria-label="Navigasi komentar">
                <a class="back-link" href="/admin">
                    <span class="back-icon" aria-hidden="true">
                        <i class="fa-solid fa-arrow-left"></i>
                    </span>
                    <span>
                        <strong>Kembali</strong>
                        <small>Dashboard admin</small>
                    </span>
                </a>

                <div class="sidebar-card">
                    <p class="eyebrow">Status</p>
                    <div class="tabs sidebar-tabs" role="tablist">
                        {statusTabs.map((t) => (
                            <button
                                class="tab"
                                data-status={t.id}
                                role="tab"
                                aria-selected={t.id === "pending"}
                            >
                                <span>{t.badge}</span>
                                {t.label}
                            </button>
                        ))}
                    </div>
                </div>

                <div class="sidebar-card">
                    <p class="eyebrow">Ringkasan</p>
                    <ul class="sidebar-list">
                        <li>Filter komentar berdasarkan status.</li>
                        <li>Gunakan pencarian untuk menemukan penulis atau isi.</li>
                        <li>Tindakan cepat tersedia di setiap baris.</li>
                    </ul>
                    <button class="ghost full refresh-btn" type="button" data-refresh>
                        <i class="fa-solid fa-rotate"></i>
                        Segarkan data
                    </button>
                </div>
            </aside>

            <main class="comment-main">
                <header class="comment-header">
                    <div>
                        <p class="eyebrow">Moderasi</p>
                        <h1>Komentar</h1>
                        <p class="subtitle">
                            Tinjau, setujui, tandai spam, atau hapus komentar yang masuk.
                        </p>
                    </div>
                    <div class="header-actions">
                        <label class="input-wrap">
                            <i class="fa-solid fa-magnifying-glass"></i>
                            <input
                                id="search"
                                type="search"
                                placeholder="Cari penulis / isi komentar"
                                aria-label="Cari komentar"
                            />
                        </label>
                        <div class="control-pill">
                            <label for="page-size">/halaman</label>
                            <select id="page-size" aria-label="Jumlah data per halaman">
                                <option value="10">10</option>
                                <option value="20" selected>20</option>
                                <option value="50">50</option>
                            </select>
                        </div>
                        <button class="ghost" type="button" data-refresh>
                            <i class="fa-solid fa-rotate"></i>
                            Muat ulang
                        </button>
                    </div>
                </header>

                <section class="comment-table-card">
                    <div class="table-header">
                        <div>
                            <p class="eyebrow">Daftar</p>
                            <h2>Tabel komentar</h2>
                        </div>
                        <span class="pill" id="total-chip">Total 0</span>
                    </div>

                    <div class="table-wrapper" aria-live="polite">
                        <table class="comment-table">
                            <thead>
                                <tr>
                                    <th>Artikel / Slug</th>
                                    <th>Penulis</th>
                                    <th>Isi</th>
                                    <th>Status</th>
                                    <th>Waktu</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="comment-table-body">
                                <tr>
                                    <td colspan="6" class="muted">Memuat...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div
                        id="comment-card-list"
                        class="comment-cards"
                        aria-live="polite"
                    >
                        <p class="muted">Memuat...</p>
                    </div>

                    <div class="pager" id="pager" hidden>
                        <button id="prev" aria-label="Halaman sebelumnya">â—€</button>
                        <span id="page-info"></span>
                        <button id="next" aria-label="Halaman berikutnya">â–¶</button>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <script>
        const tableBody = document.getElementById("comment-table-body");
        const cardList = document.getElementById("comment-card-list");
        const searchInput = document.getElementById("search");
        const pageSizeSelect = document.getElementById("page-size");
        const pager = document.getElementById("pager");
        const prevBtn = document.getElementById("prev");
        const nextBtn = document.getElementById("next");
        const pageInfo = document.getElementById("page-info");
        const totalChip = document.getElementById("total-chip");
        const statusButtons = document.querySelectorAll(".tab[data-status]");
        const refreshButtons = document.querySelectorAll("[data-refresh]");

        let status = "pending";
        let page = 1;
        let total = 0;

        const escapeHtml = (value = "") =>
            value
                .toString()
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#39;");

        const formatDate = (dateString) =>
            new Date(dateString).toLocaleString("id-ID", {
                dateStyle: "medium",
                timeStyle: "short",
            });

        const statusLabel = (value) => value || "pending";

        const setLoading = () => {
            if (tableBody) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="muted">Memuat...</td>
                    </tr>
                `;
            }
            if (cardList) {
                cardList.innerHTML = `<p class="muted">Memuat...</p>`;
            }
        };

        const renderList = (rows) => {
            if (!tableBody || !cardList) return;

            if (!rows.length) {
                tableBody.innerHTML = `
                    <tr class="empty-row">
                        <td colspan="6">
                            <div class="empty-state">
                                <p class="muted">Belum ada komentar.</p>
                                <small class="muted">Coba ubah filter atau tambah komentar baru.</small>
                            </div>
                        </td>
                    </tr>
                `;
                cardList.innerHTML = `
                    <div class="empty-card">
                        <p class="muted">Belum ada komentar.</p>
                        <small class="muted">Coba ubah filter atau tambah komentar baru.</small>
                    </div>
                `;
                return;
            }

            tableBody.innerHTML = rows
                .map(
                    (c) => `
                    <tr data-id="${c.id}">
                        <td>
                            <div class="cell-title">${escapeHtml(c.slug || c.article_slug || "tanpa-slug")}</div>
                            <div class="cell-meta">Artikel ${escapeHtml(c.article_slug || "tidak diketahui")}</div>
                        </td>
                        <td>
                            <div class="cell-title">${escapeHtml(c.name || "Anon")}</div>
                            <div class="cell-meta">${escapeHtml(c.email || "â€“")}</div>
                        </td>
                        <td class="cell-content">${escapeHtml(c.message || "")}</td>
                        <td>
                            <span class="status-chip status-${statusLabel(c.status)}">
                                ${statusLabel(c.status)}
                            </span>
                        </td>
                        <td class="cell-meta">${formatDate(c.created_at)}</td>
                        <td class="cell-actions">
                            <div class="action-group">
                                <button data-action="approve" class="action-btn action-approve" title="Setujui komentar">
                                    <i class="fa-solid fa-check"></i><span>Approve</span>
                                </button>
                                <button data-action="pending" class="action-btn action-pending" title="Tandai pending">
                                    <i class="fa-solid fa-clock"></i><span>Pending</span>
                                </button>
                                <button data-action="spam" class="action-btn action-spam" title="Tandai spam">
                                    <i class="fa-solid fa-ban"></i><span>Spam</span>
                                </button>
                                <button data-action="delete" class="action-btn action-delete" title="Hapus komentar">
                                    <i class="fa-solid fa-trash"></i><span>Hapus</span>
                                </button>
                            </div>
                        </td>
                    </tr>
                `,
                )
                .join("");

            cardList.innerHTML = rows
                .map(
                    (c) => `
                    <article class="comment-card" data-id="${c.id}">
                        <header class="card-top">
                            <div class="id-chip">${escapeHtml(c.slug || c.article_slug || "tanpa-slug")}</div>
                            <span class="status-chip status-${statusLabel(c.status)}">${statusLabel(c.status)}</span>
                        </header>
                        <div class="card-body">
                            <div class="author-block">
                                <div class="avatar">${escapeHtml((c.name || c.email || "A").slice(0, 1).toUpperCase())}</div>
                                <div>
                                    <p class="author">${escapeHtml(c.name || "Anon")}</p>
                                    <p class="meta">${escapeHtml(c.email || "â€“")}</p>
                                </div>
                            </div>
                            <div class="content-block">
                                <p class="content">${escapeHtml(c.message || "")}</p>
                                <p class="meta time">${formatDate(c.created_at)}</p>
                            </div>
                        </div>
                        <div class="actions">
                            <div class="action-group">
                                <button data-action="approve" class="action-btn action-approve">
                                    <i class="fa-solid fa-check"></i><span>Approve</span>
                                </button>
                                <button data-action="pending" class="action-btn action-pending">
                                    <i class="fa-solid fa-clock"></i><span>Pending</span>
                                </button>
                                <button data-action="spam" class="action-btn action-spam">
                                    <i class="fa-solid fa-ban"></i><span>Spam</span>
                                </button>
                                <button data-action="delete" class="action-btn action-delete">
                                    <i class="fa-solid fa-trash"></i><span>Hapus</span>
                                </button>
                            </div>
                        </div>
                    </article>
                `,
                )
                .join("");
        };

        const updatePager = (count, limit) => {
            const totalPages = Math.max(1, Math.ceil(count / limit));
            pager.hidden = totalPages <= 1;
            prevBtn.disabled = page <= 1;
            nextBtn.disabled = page >= totalPages;
            pageInfo.textContent = `${page} / ${totalPages} (total ${count})`;
        };

        const load = async () => {
            setLoading();
            const limit = Number(pageSizeSelect.value);
            const q = searchInput.value.trim();
            const url = new URL("/api/admin/comments", window.location.origin);
            url.searchParams.set("status", status);
            url.searchParams.set("page", page.toString());
            url.searchParams.set("limit", limit.toString());
            if (q) url.searchParams.set("q", q);

            try {
                const res = await fetch(url.toString());
                const data = await res.json();

                if (!res.ok) throw new Error(data.error || "Gagal memuat");

                renderList(data.data || []);
                total = data.count || 0;
                if (totalChip) totalChip.textContent = `Total ${total}`;
                updatePager(total, limit);
            } catch (error) {
                const message = error?.message || "Gagal memuat";
                if (tableBody) {
                    tableBody.innerHTML = `<tr><td colspan="6" class="muted">Error: ${message}</td></tr>`;
                }
                if (cardList) {
                    cardList.innerHTML = `<p class="muted">Error: ${message}</p>`;
                }
                pager.hidden = true;
            }
        };

        statusButtons.forEach((btn) =>
            btn.addEventListener("click", () => {
                statusButtons.forEach((b) => {
                    b.classList.remove("active");
                    b.setAttribute("aria-selected", "false");
                });
                btn.classList.add("active");
                btn.setAttribute("aria-selected", "true");
                status = btn.dataset.status || "pending";
                page = 1;
                load();
            }),
        );

        searchInput.addEventListener("input", () => {
            page = 1;
            load();
        });

        pageSizeSelect.addEventListener("change", () => {
            page = 1;
            load();
        });

        refreshButtons.forEach((btn) =>
            btn.addEventListener("click", () => {
                page = 1;
                load();
            }),
        );

        prevBtn.addEventListener("click", () => {
            page = Math.max(1, page - 1);
            load();
        });
        nextBtn.addEventListener("click", () => {
            const maxPage = Math.ceil(total / Number(pageSizeSelect.value));
            page = Math.min(maxPage, page + 1);
            load();
        });

        const handleAction = async (event) => {
            if (!(event.target instanceof Element)) return;
            const btn = event.target.closest("button[data-action]");
            if (!btn) return;

            const host = btn.closest("[data-id]");
            const id = host?.dataset.id;
            const action = btn.dataset.action;
            if (!id || !action) return;
            if (action === "delete") {
                const ok = await window.adminConfirm?.(
                    "Hapus komentar ini?",
                    "Hapus komentar",
                    "Hapus",
                    "Batal",
                );
                if (!ok) return;
            }

            const payload = { id };
            let method = "POST";
            if (action === "delete") {
                method = "DELETE";
            } else {
                payload.status = action;
            }

            btn.disabled = true;
            btn.classList.add("is-loading");

            try {
                const res = await fetch("/api/admin/comments", {
                    method,
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload),
                });
                const data = await res.json();
                if (!res.ok) throw new Error(data.error || "Gagal memproses");
                await load();
            } catch (err) {
                await window.adminAlert?.(err?.message || "Gagal memproses");
            } finally {
                btn.disabled = false;
                btn.classList.remove("is-loading");
            }
        };

        tableBody?.addEventListener("click", handleAction);
        cardList?.addEventListener("click", handleAction);

        load();
    </script>

    <style>
        .comment-shell {
            max-width: 1300px;
            margin: 0 auto;
            padding: 1.25rem 1rem 2.5rem;
        }

        .comment-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 1.25rem;
        }

        @media (max-width: 1024px) {
            .comment-layout {
                grid-template-columns: 1fr;
            }
        }

        .comment-sidebar {
            position: sticky;
            top: 1rem;
            align-self: start;
            display: flex;
            flex-direction: column;
            gap: 0.85rem;
        }

        .back-link {
            display: flex;
            gap: 0.7rem;
            align-items: center;
            padding: 0.85rem 0.95rem;
            border-radius: 0.9rem;
            border: 1px solid var(--color-border);
            background: color-mix(in srgb, var(--color-foreground) 8%, transparent);
            text-decoration: none;
            color: inherit;
            box-shadow: 0 10px 24px color-mix(in srgb, var(--color-foreground) 10%, transparent);
        }

        .back-link small {
            display: block;
            color: color-mix(in srgb, var(--color-foreground) 60%, transparent);
            font-size: 0.8rem;
        }

        .back-icon {
            width: 2.2rem;
            height: 2.2rem;
            border-radius: 0.75rem;
            display: grid;
            place-items: center;
            background: color-mix(in srgb, var(--color-foreground) 12%, transparent);
        }

        .sidebar-card {
            border: 1px solid var(--color-border);
            border-radius: 1rem;
            padding: 0.85rem 0.9rem;
            background: color-mix(in srgb, var(--color-card) 94%, transparent);
            box-shadow: 0 12px 26px color-mix(in srgb, var(--color-foreground) 10%, transparent);
        }

        .sidebar-list {
            margin: 0.35rem 0 0.8rem;
            padding-left: 1.1rem;
            color: color-mix(in srgb, var(--color-foreground) 70%, transparent);
            display: grid;
            gap: 0.25rem;
            font-size: 0.9rem;
        }

        .comment-main {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .comment-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 1rem;
            flex-wrap: wrap;
            padding: 1rem;
            border-radius: 1rem;
            border: 1px dashed color-mix(in srgb, var(--color-foreground) 16%, transparent);
            background: radial-gradient(
                    circle at 12% 20%,
                    color-mix(in srgb, var(--color-primary) 12%, transparent),
                    transparent 32%
                ),
                radial-gradient(
                    circle at 88% 15%,
                    color-mix(in srgb, var(--color-foreground) 10%, transparent),
                    transparent 30%
                ),
                color-mix(in srgb, var(--color-card) 96%, transparent);
        }

        .eyebrow {
            text-transform: uppercase;
            letter-spacing: 0.14em;
            margin: 0;
            color: color-mix(in srgb, var(--color-foreground) 60%, transparent);
            font-size: 0.75rem;
        }

        h1 {
            margin: 0.2rem 0;
            font-family: var(--font-display);
            letter-spacing: 0.02em;
            text-transform: uppercase;
        }

        h2 {
            margin: 0.1rem 0;
            font-size: clamp(1rem, 1.8vw, 1.25rem);
        }

        .subtitle {
            margin: 0;
            color: color-mix(in srgb, var(--color-foreground) 70%, transparent);
            max-width: 64ch;
        }

        .header-actions {
            display: flex;
            gap: 0.65rem;
            align-items: center;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        .input-wrap {
            display: inline-flex;
            align-items: center;
            gap: 0.45rem;
            padding: 0.55rem 0.75rem;
            border: 1px solid var(--color-border);
            border-radius: 14px;
            background: var(--color-card);
            min-width: min(360px, 100%);
        }

        .input-wrap input {
            border: none;
            background: transparent;
            outline: none;
            width: 100%;
            font-size: 0.95rem;
        }

        .control-pill {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.45rem 0.6rem;
            border-radius: 12px;
            border: 1px solid var(--color-border);
            background: color-mix(in srgb, var(--color-foreground) 6%, transparent);
            font-weight: 700;
        }

        .control-pill select {
            border: none;
            background: transparent;
            outline: none;
            font-weight: 700;
        }

        .tabs {
            display: flex;
            gap: 0.55rem;
            flex-wrap: wrap;
        }

        .sidebar-tabs {
            display: grid;
            gap: 0.5rem;
            margin-top: 0.6rem;
        }

        .tab {
            padding: 0.55rem 1rem;
            border: 1px solid var(--color-border);
            border-radius: 999px;
            background: var(--color-card);
            cursor: pointer;
            font-weight: 800;
            display: inline-flex;
            align-items: center;
            gap: 0.45rem;
            box-shadow: 0 6px 14px color-mix(in srgb, var(--color-foreground) 8%, transparent);
            width: fit-content;
        }

        .sidebar-tabs .tab {
            width: 100%;
            justify-content: space-between;
        }

        .tab.active {
            background: var(--color-primary);
            color: var(--color-primary-foreground);
            border-color: transparent;
        }

        .comment-table-card {
            border: 1px solid var(--color-border);
            border-radius: 1rem;
            background: linear-gradient(
                    135deg,
                    color-mix(in srgb, var(--color-card) 98%, transparent),
                    color-mix(in srgb, var(--color-primary) 6%, var(--color-card))
                );
            padding: 1.1rem;
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            box-shadow:
                0 18px 36px color-mix(in srgb, var(--color-foreground) 10%, transparent),
                0 1px 0 color-mix(in srgb, var(--color-foreground) 6%, transparent);
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .table-wrapper {
            width: 100%;
            overflow: auto;
            border: 1px solid var(--color-border);
            border-radius: 12px;
            background: color-mix(in srgb, var(--color-background) 96%, transparent);
            box-shadow: inset 0 1px 0 color-mix(in srgb, var(--color-foreground) 5%, transparent);
        }

        .comment-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 760px;
        }

        .comment-table th,
        .comment-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid color-mix(in srgb, var(--color-foreground) 14%, transparent);
            vertical-align: top;
        }

        .comment-table th:first-child,
        .comment-table td:first-child {
            padding-left: 1rem;
        }

        .comment-table th:last-child,
        .comment-table td:last-child {
            padding-right: 1rem;
        }

        .comment-table th {
            font-size: 0.85rem;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            color: color-mix(in srgb, var(--color-foreground) 70%, transparent);
            background: color-mix(in srgb, var(--color-foreground) 8%, transparent);
            position: sticky;
            top: 0;
            border-bottom: 1px solid color-mix(in srgb, var(--color-foreground) 18%, transparent);
        }

        .comment-table tbody tr:nth-child(odd) {
            background: color-mix(in srgb, var(--color-foreground) 3%, transparent);
        }

        .comment-table tbody tr:hover {
            background: color-mix(in srgb, var(--color-primary) 6%, transparent);
            transition: background 150ms ease;
        }

        .cell-title {
            font-weight: 700;
            font-size: 0.95rem;
            line-height: 1.35;
            max-width: 26ch;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .cell-meta {
            color: color-mix(in srgb, var(--color-foreground) 65%, transparent);
            font-size: 0.85rem;
            margin-top: 0.1rem;
            white-space: nowrap;
            font-family: var(--font-mono);
        }

        .cell-content {
            max-width: 420px;
            white-space: normal;
            line-height: 1.4;
            color: color-mix(in srgb, var(--color-foreground) 82%, transparent);
        }

        .cell-actions {
            display: flex;
            gap: 0.35rem;
            flex-wrap: wrap;
            min-width: 240px;
        }

        .action-group {
            display: flex;
            gap: 0.4rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .comment-cards {
            display: none;
            gap: 1rem;
        }

        @media (max-width: 820px) {
            .comment-cards {
                display: grid;
            }
            .table-wrapper {
                display: none;
            }
        }

        .comment-card {
            border: 1px solid var(--color-border);
            border-radius: 16px;
            padding: 0.95rem 1.05rem;
            background: var(--color-card);
            box-shadow: 0 12px 28px color-mix(in srgb, var(--color-foreground) 10%, transparent);
            display: grid;
            gap: 0.65rem;
        }

        .card-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.6rem;
            flex-wrap: wrap;
        }

        .id-chip {
            padding: 0.35rem 0.7rem;
            border-radius: 10px;
            background: color-mix(in srgb, var(--color-foreground) 6%, transparent);
            font-family: var(--font-mono);
            font-size: 0.8rem;
        }

        .card-body {
            display: grid;
            gap: 0.65rem;
        }

        .author-block {
            display: flex;
            gap: 0.65rem;
            align-items: center;
        }

        .avatar {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background: color-mix(in srgb, var(--color-primary) 18%, transparent);
            display: grid;
            place-items: center;
            font-weight: 800;
        }

        .author {
            margin: 0;
            font-weight: 800;
            letter-spacing: 0.01em;
        }

        .meta {
            margin: 0;
            font-size: 0.82rem;
            color: color-mix(in srgb, var(--color-foreground) 60%, transparent);
        }

        .content-block {
            display: grid;
            gap: 0.25rem;
        }

        .content {
            margin: 0;
            white-space: pre-wrap;
            line-height: 1.5;
        }

        .meta.time {
            font-size: 0.78rem;
        }

        .actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .ghost {
            padding: 0.45rem 0.85rem;
            border-radius: 10px;
            border: 1px solid var(--color-border);
            background: var(--color-card);
            cursor: pointer;
            font-weight: 800;
            display: inline-flex;
            align-items: center;
            gap: 0.45rem;
            transition: border-color 150ms ease, transform 120ms ease;
        }

        .ghost:hover,
        .ghost:focus-visible {
            border-color: color-mix(in srgb, var(--color-primary) 50%, transparent);
            transform: translateY(-1px);
        }
        .action-btn {
            padding: 0.42rem 0.78rem;
            border-radius: 10px;
            border: 1px solid transparent;
            background: color-mix(in srgb, var(--color-foreground) 7%, transparent);
            cursor: pointer;
            font-weight: 800;
            display: inline-flex;
            align-items: center;
            gap: 0.38rem;
            transition:
                transform 120ms ease,
                box-shadow 160ms ease,
                border-color 140ms ease,
                background-color 140ms ease;
            color: inherit;
            font-size: 0.9rem;
            backdrop-filter: saturate(120%);
            letter-spacing: 0.01em;
        }

        .action-btn:hover,
        .action-btn:focus-visible {
            transform: translateY(-1px);
            box-shadow: 0 8px 18px color-mix(in srgb, var(--color-foreground) 12%, transparent);
        }

        .action-btn i {
            font-size: 0.95rem;
        }

        .action-approve {
            background: linear-gradient(135deg, color-mix(in srgb, #22c55e 22%, transparent), color-mix(in srgb, #16a34a 32%, transparent));
            border-color: color-mix(in srgb, #22c55e 42%, transparent);
            color: #f0fdf4;
            box-shadow: 0 10px 18px color-mix(in srgb, #16a34a 25%, transparent);
        }

        .action-pending {
            background: linear-gradient(135deg, color-mix(in srgb, #f59e0b 20%, transparent), color-mix(in srgb, #ea580c 32%, transparent));
            border-color: color-mix(in srgb, #f59e0b 40%, transparent);
            color: #fff7ed;
            box-shadow: 0 10px 18px color-mix(in srgb, #f59e0b 24%, transparent);
        }

        .action-spam {
            background: linear-gradient(135deg, color-mix(in srgb, #ef4444 20%, transparent), color-mix(in srgb, #dc2626 32%, transparent));
            border-color: color-mix(in srgb, #ef4444 42%, transparent);
            color: #fff1f2;
            box-shadow: 0 10px 18px color-mix(in srgb, #ef4444 24%, transparent);
        }

        .action-delete {
            background: linear-gradient(135deg, color-mix(in srgb, var(--color-foreground) 10%, transparent), color-mix(in srgb, var(--color-foreground) 18%, transparent));
            border-color: color-mix(in srgb, var(--color-foreground) 32%, transparent);
            color: color-mix(in srgb, var(--color-background) 96%, transparent);
            box-shadow: 0 10px 18px color-mix(in srgb, var(--color-foreground) 20%, transparent);
        }

        .action-btn.is-loading {
            opacity: 0.65;
            pointer-events: none;
        }

        .muted {
            color: color-mix(in srgb, var(--color-foreground) 60%, transparent);
        }

        .status-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.2rem 0.7rem;
            border-radius: 999px;
            font-weight: 700;
            text-transform: capitalize;
            border: 1px solid transparent;
        }

        .status-pending {
            background: color-mix(in srgb, #f59e0b 16%, transparent);
            color: #b45309;
            border-color: color-mix(in srgb, #f59e0b 35%, transparent);
        }

        .status-approved {
            background: color-mix(in srgb, #22c55e 18%, transparent);
            color: #15803d;
            border-color: color-mix(in srgb, #22c55e 35%, transparent);
        }

        .status-spam {
            background: color-mix(in srgb, #ef4444 18%, transparent);
            color: #b91c1c;
            border-color: color-mix(in srgb, #ef4444 35%, transparent);
        }

        .status-all {
            background: color-mix(in srgb, var(--color-foreground) 10%, transparent);
            color: var(--color-foreground);
            border-color: color-mix(in srgb, var(--color-foreground) 25%, transparent);
        }

        .empty-state {
            text-align: center;
            padding: 0.75rem 0;
        }

        .pager {
            display: flex;
            gap: 0.6rem;
            align-items: center;
            justify-content: flex-end;
            margin-top: 0.35rem;
        }

        .pager button {
            padding: 0.45rem 0.75rem;
            border-radius: 9px;
            border: 1px solid var(--color-border);
            background: var(--color-card);
            cursor: pointer;
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.35rem 0.75rem;
            border-radius: 999px;
            background: color-mix(in srgb, var(--color-primary) 12%, transparent);
            color: var(--color-primary);
            font-weight: 700;
            border: 1px solid color-mix(in srgb, var(--color-primary) 32%, transparent);
        }

        @media (max-width: 720px) {
            .comment-shell {
                padding: 0.9rem 0.65rem 1.6rem;
            }

            .header-actions {
                width: 100%;
            }

            .input-wrap {
                flex: 1;
                min-width: 0;
                width: 100%;
            }

            .comment-table-card {
                padding: 0.85rem;
            }

            .actions {
                flex-direction: column;
                align-items: stretch;
            }

            .actions .ghost {
                width: 100%;
                justify-content: center;
                text-align: center;
            }
        }
    </style>
</Layout>
